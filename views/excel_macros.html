<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlaeAutomates 2.0 - Excel Macros</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <!-- Mobile Block Message -->
    <div class="mobile-block">
        <div class="mobile-block-content">
            <svg class="icon" viewBox="0 0 24 24">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
            <h1>Desktop Only</h1>
            <p>This application is designed for desktop use only. Please access it from a computer with a larger screen for the best experience.</p>
            <p style="color: var(--text-muted); font-size: 0.9rem;">Minimum screen width required: 768px</p>
        </div>
    </div>

    <!-- Modern Navigation Bar -->
    <nav class="modern-nav">
        <div class="nav-container">
            <div class="nav-brand" onclick="navigateTo('/')">
                <span class="brand-text">AlaeAutomates</span>
            </div>
            <div class="nav-right">
                <a href="https://alaeautomates.up.railway.app/" class="nav-item old-version" target="_blank">Old Version</a>
            </div>
        </div>
    </nav>

    <!-- Secondary Navigation -->
    <div class="secondary-nav">
        <div class="secondary-nav-container">
            <a href="/monthly_statements.html" class="secondary-nav-item">Monthly Statements</a>
            <a href="/invoices.html" class="secondary-nav-item">Invoice Processing</a>
            <a href="/cc_batch.html" class="secondary-nav-item">CC Batch Processing</a>
            <a href="/excel_macros.html" class="secondary-nav-item active">Excel Macros</a>
        </div>
    </div>

    <div class="feature-page-container">
        <!-- Background Animation -->
        <div class="feature-background-animation">
            <div class="feature-floating-element feature-element-1"></div>
            <div class="feature-floating-element feature-element-2"></div>
            <div class="feature-floating-element feature-element-3"></div>
            <div class="feature-floating-element feature-element-4"></div>
            
            <!-- Optimized feature fire dots -->
            <div class="feature-fire-dot feature-fire-dot-1"></div>
            <div class="feature-fire-dot feature-fire-dot-3"></div>
            <div class="feature-fire-dot feature-fire-dot-5"></div>
            
            <!-- Optimized feature white dots -->
            <div class="feature-white-dot feature-white-dot-1"></div>
            <div class="feature-white-dot feature-white-dot-3"></div>
        </div>

        <div class="feature-content">
            <div class="feature-card">
                <div class="form-group-enhanced">
                    <label class="form-label-enhanced">
                        <i data-lucide="file-spreadsheet" class="icon" style="margin-right: 8px;"></i>
                        Excel VBA Macros Collection
                    </label>
                    <p style="color: rgba(255,255,255,0.7); margin-bottom: 2rem;">Professional Excel macros for data processing and automation tasks.</p>
                </div>

                <div class="macros-grid">
                    <!-- Clean-up & Format Macro -->
                    <div class="macro-card">
                        <h3 class="macro-card-title">
                            <i data-lucide="sparkles" class="icon"></i>
                            Clean-up & Format Macro
                        </h3>
                        <p class="macro-card-description">Removes empty rows and columns, trims whitespace from cells, applies consistent formatting, and auto-fits column widths.</p>
                        <button class="btn-enhanced btn-secondary-enhanced macro-card-button" data-macro="cleanupFormat" type="button">
                            <i data-lucide="eye" class="icon"></i>
                            View Code
                        </button>
                    </div>

                    <!-- Sort & Sum Macro -->
                    <div class="macro-card">
                        <h3 class="macro-card-title">
                            <i data-lucide="arrow-up-down" class="icon"></i>
                            Sort & Sum Macro
                        </h3>
                        <p class="macro-card-description">Sorts data by specified column, adds sum totals for numeric columns, and preserves header formatting with professional styling.</p>
                        <button class="btn-enhanced btn-secondary-enhanced macro-card-button" data-macro="sortSum" type="button">
                            <i data-lucide="eye" class="icon"></i>
                            View Code
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="/js/script.js"></script>
    <script src="/js/professional-modal.js"></script>
    <script>
        // BRAND NEW IMPLEMENTATION - 100% WORKING BUTTONS
        
        const MACRO_DATA = {
            cleanupFormat: {
                title: "Clean-up & Format Macro",
                code: `Sub CleanupAndFormat()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim i As Long
    Dim j As Long
    
    Set ws = ActiveSheet
    
    ' Find the last row and column with data
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    
    Application.ScreenUpdating = False
    
    ' Remove empty rows
    For i = lastRow To 1 Step -1
        If Application.WorksheetFunction.CountA(ws.Rows(i)) = 0 Then
            ws.Rows(i).Delete
        End If
    Next i
    
    ' Remove empty columns
    For j = lastCol To 1 Step -1
        If Application.WorksheetFunction.CountA(ws.Columns(j)) = 0 Then
            ws.Columns(j).Delete
        End If
    Next j
    
    ' Recalculate ranges after deletion
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    
    ' Trim whitespace from all cells
    For i = 1 To lastRow
        For j = 1 To lastCol
            If Not IsEmpty(ws.Cells(i, j)) Then
                ws.Cells(i, j).Value = Trim(ws.Cells(i, j).Value)
            End If
        Next j
    Next i
    
    ' Auto-fit all columns
    ws.Columns.AutoFit
    
    ' Apply basic formatting
    With ws.Range(ws.Cells(1, 1), ws.Cells(lastRow, lastCol))
        .Font.Name = "Arial"
        .Font.Size = 10
        .Borders.LineStyle = xlContinuous
        .Borders.Weight = xlThin
    End With
    
    ' Format header row if it exists
    If lastRow > 0 Then
        With ws.Range(ws.Cells(1, 1), ws.Cells(1, lastCol))
            .Font.Bold = True
            .Interior.Color = RGB(220, 220, 220)
        End With
    End If
    
    Application.ScreenUpdating = True
    
    MsgBox "Cleanup and formatting completed!", vbInformation
End Sub`
            },
            sortSum: {
                title: "Sort & Sum Macro",
                code: `Sub SortAndSum()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range
    Dim response As Integer
    Dim sortCol As Integer
    
    Set ws = ActiveSheet
    
    ' Find the last row and column with data
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    
    If lastRow <= 1 Then
        MsgBox "No data to sort!", vbExclamation
        Exit Sub
    End If
    
    ' Ask user which column to sort by
    sortCol = InputBox("Enter column number to sort by (1 for A, 2 for B, etc.):", "Sort Column", 1)
    
    If sortCol < 1 Or sortCol > lastCol Then
        MsgBox "Invalid column number!", vbExclamation
        Exit Sub
    End If
    
    Set dataRange = ws.Range(ws.Cells(2, 1), ws.Cells(lastRow, lastCol))
    
    Application.ScreenUpdating = False
    
    ' Sort the data (excluding header row)
    dataRange.Sort Key1:=ws.Cells(2, sortCol), Order1:=xlAscending, Header:=xlNo
    
    ' Ask if user wants to add sum row
    response = MsgBox("Add sum row for numeric columns?", vbYesNo + vbQuestion, "Add Totals")
    
    If response = vbYes Then
        Dim i As Integer
        Dim sumRow As Long
        sumRow = lastRow + 2
        
        ' Add "Total:" label
        ws.Cells(sumRow, 1).Value = "Total:"
        ws.Cells(sumRow, 1).Font.Bold = True
        
        ' Add sums for numeric columns
        For i = 2 To lastCol
            If IsNumeric(ws.Cells(2, i).Value) Then
                ws.Cells(sumRow, i).Formula = "=SUM(" & ws.Range(ws.Cells(2, i), ws.Cells(lastRow, i)).Address & ")"
                ws.Cells(sumRow, i).Font.Bold = True
            End If
        Next i
        
        ' Format sum row
        With ws.Range(ws.Cells(sumRow, 1), ws.Cells(sumRow, lastCol))
            .Borders(xlEdgeTop).LineStyle = xlContinuous
            .Borders(xlEdgeTop).Weight = xlMedium
        End With
    End If
    
    ' Auto-fit columns
    ws.Columns.AutoFit
    
    Application.ScreenUpdating = True
    
    MsgBox "Sort and sum completed!", vbInformation
End Sub`
            }
        };
        
        class MacroViewer {
            constructor() {
                this.professionalUI = window.ProfessionalUI;
                this.init();
            }
            
            init() {
                // Wait for DOM to be fully ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', () => this.setup());
                } else {
                    this.setup();
                }
            }
            
            setup() {
                this.bindEvents();
                console.log('âœ… Professional MacroViewer initialized successfully');
            }
            
            bindEvents() {
                // Bind macro buttons
                const buttons = document.querySelectorAll('[data-macro]');
                console.log(`ðŸŽ¯ Found ${buttons.length} macro buttons`);
                
                buttons.forEach(button => {
                    const macroKey = button.getAttribute('data-macro');
                    console.log(`ðŸ”— Binding button for macro: ${macroKey}`);
                    
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(`ðŸš€ Button clicked for macro: ${macroKey}`);
                        this.showMacro(macroKey);
                    });
                });
            }
            
            showMacro(macroKey) {
                console.log(`ðŸ“– Showing macro: ${macroKey}`);
                
                const macro = MACRO_DATA[macroKey];
                if (!macro) {
                    this.professionalUI.showAlert('error', 'Error', `Macro "${macroKey}" not found.`);
                    return;
                }
                
                // Use the professional code modal
                this.professionalUI.showCodeModal(macro.title, macro.code);
                console.log(`âœ… Professional modal opened for: ${macro.title}`);
            }
        }
        
        // Initialize the macro viewer
        new MacroViewer();
    </script>
    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>